<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blood Pressure Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    input { width: 100%; }
    canvas { max-width: 100%; height: 300px; }
    button { margin-top: 10px; padding: 8px 12px; }
  </style>
</head>
<body>

  <h1>Blood Pressure Tracker</h1>
  <canvas id="bpChart"></canvas>

  <table id="bpTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Systolic</th>
        <th>Diastolic</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows go here -->
    </tbody>
  </table>
  <button onclick="addRow()">Add New Row</button>

  <script>
    const data = [
      { date: '2025-05-17', systolic: 120, diastolic: 80 },
      { date: '2025-05-18', systolic: 125, diastolic: 82 }
    ];

    const chartCtx = document.getElementById('bpChart').getContext('2d');
    const bpChart = new Chart(chartCtx, {
      type: 'line',
      data: {
        labels: data.map(d => d.date),
        datasets: [
          {
            label: 'Systolic',
            data: data.map(d => d.systolic),
            borderColor: '#8884d8',
            fill: false,
          },
          {
            label: 'Diastolic',
            data: data.map(d => d.diastolic),
            borderColor: '#82ca9d',
            fill: false,
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: false }
        }
      }
    });

    function updateChart() {
      bpChart.data.labels = data.map(d => d.date);
      bpChart.data.datasets[0].data = data.map(d => d.systolic);
      bpChart.data.datasets[1].data = data.map(d => d.diastolic);
      bpChart.update();
    }

    function addRow() {
      const today = new Date().toISOString().split('T')[0];
      data.push({ date: today, systolic: 0, diastolic: 0 });
      renderTable();
      updateChart();
    }

    function renderTable() {
      const tbody = document.getElementById('bpTable').querySelector('tbody');
      tbody.innerHTML = '';
      data.forEach((entry, index) => {
        const row = document.createElement('tr');

        ['date', 'systolic', 'diastolic'].forEach(field => {
          const td = document.createElement('td');
          const input = document.createElement('input');
          input.type = field === 'date' ? 'date' : 'number';
          input.value = entry[field];
          input.oninput = (e) => {
            entry[field] = field === 'date' ? e.target.value : parseInt(e.target.value, 10);
            updateChart();
          };
          td.appendChild(input);
          row.appendChild(td);
        });

        tbody.appendChild(row);
      });
    }

    renderTable();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Timeline</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            overflow-y: hidden;
            overflow-x: auto;
            background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%);
            height: 100vh;
        }

        #timeline-container {
            position: relative;
            height: 100vh;
            min-width: 100vw;
            width: max-content;
        }

        #timeline {
            position: absolute;
            bottom: 33.33vh;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #f7b731);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .date-marker {
            position: absolute;
            bottom: 33.33vh;
            transform: translateX(-50%);
        }

        .date-label {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-size: 14px;
            font-weight: bold;
            white-space: nowrap;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
            pointer-events: none;
        }

        .date-dot {
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 12px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }



        .photo {
            position: absolute;
            width: 280px;
            height: 180px;
            object-fit: cover;
            border: 1px solid #fff;
            border-radius: 5px;
            /*box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);*/
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .photo:hover {
            transform: scale(1.05) translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.7);
            z-index: 1000;
        }

        .photo-description {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-10px);
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            white-space: nowrap;
            max-width: 300px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .photo:hover .photo-description {
            opacity: 1;
        }

        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <div id="loading">Loading photos...</div>
    <div id="timeline-container">
        <div id="timeline"></div>
    </div>

    <script>
        // Sample metadata - replace this with your actual JSON file
        const sampleMetadata = [
            { filename: "photo1.jpg", date: "2024-03-15", description: "Sunset at the beach" },
            { filename: "photo2.jpg", date: "2024-03-15", description: "Ocean waves" },
            { filename: "photo3.jpg", date: "2024-03-15", description: "Palm trees silhouette" },
            { filename: "photo4.jpg", date: "2024-03-16", description: "Morning coffee" },
            { filename: "photo5.jpg", date: "2024-03-16", description: "Breakfast view" },
            { filename: "photo6.jpg", date: "2024-03-18", description: "City skyline" },
            { filename: "photo7.jpg", date: "2024-03-20", description: "Mountain hiking" },
            { filename: "photo8.jpg", date: "2024-03-20", description: "Trail marker" },
            { filename: "photo9.jpg", date: "2024-03-22", description: "Garden flowers" },
            { filename: "photo10.jpg", date: "2024-03-25", description: "Evening lights" }
        ];

        async function loadMetadata() {
            // To use actual JSON file, uncomment below and comment out the return statement
            // const response = await fetch('metadata.json');
            // return await response.json();
            return sampleMetadata;
        }

        function parseDate(dateStr) {
            return new Date(dateStr);
        }

        function formatDate(date) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }

        async function initTimeline() {
            const metadata = await loadMetadata();
            
            // Group photos by date
            const photosByDate = {};
            metadata.forEach(photo => {
                if (!photosByDate[photo.date]) {
                    photosByDate[photo.date] = [];
                }
                // Limit to 3 photos per date
                if (photosByDate[photo.date].length < 3) {
                    photosByDate[photo.date].push(photo);
                }
            });

            // Sort dates
            const dates = Object.keys(photosByDate).sort((a, b) => 
                parseDate(a) - parseDate(b)
            );

            if (dates.length === 0) {
                document.getElementById('loading').textContent = 'No photos found';
                return;
            }

            const container = document.getElementById('timeline-container');
            const dateSpacing = 300; // pixels between dates
            const photoSpacing = 20; // pixels between stacked photos and from timeline
            const firstPhotoOffset = 20; // pixels from timeline to first photo

            // Calculate total width needed
            const totalWidth = dates.length * dateSpacing + 400;
            container.style.width = totalWidth + 'px';

            // Create date markers and photo stacks
            dates.forEach((date, idx) => {
                const xPos = (idx + 1) * dateSpacing;
                
                // Create date marker
                const marker = document.createElement('div');
                marker.className = 'date-marker';
                marker.style.left = xPos + 'px';

                const dot = document.createElement('div');
                dot.className = 'date-dot';
                
                const label = document.createElement('div');
                label.className = 'date-label';
                label.textContent = formatDate(parseDate(date));
                
                marker.appendChild(dot);
                marker.appendChild(label);
                container.appendChild(marker);

                // Create photo stack
                const photos = photosByDate[date];
                photos.forEach((photo, photoIdx) => {
                    const photoEl = document.createElement('img');
                    photoEl.className = 'photo';
                    photoEl.src = `photos/${photo.filename}`;
                    photoEl.alt = photo.description;
                    
                    // Position photo in stack
                    photoEl.style.position = 'absolute';
                    photoEl.style.bottom = `calc(33.33vh + ${firstPhotoOffset + (photoIdx * (180 + photoSpacing))}px)`;
                    photoEl.style.left = (xPos - 140) + 'px';
                    
                    // Add description tooltip
                    const desc = document.createElement('div');
                    desc.className = 'photo-description';
                    desc.textContent = photo.description;
                    photoEl.appendChild(desc);
                    
                    container.appendChild(photoEl);
                });
            });

            // Scroll to the right (most recent)
            window.scrollTo({ left: totalWidth, behavior: 'smooth' });

            document.getElementById('loading').style.display = 'none';
        }

        // Initialize when page loads
        window.addEventListener('load', initTimeline);
    </script>
</body>
</html>